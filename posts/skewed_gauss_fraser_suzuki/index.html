<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Python implementation of the Fraser-Suzuki skewed Gaussian function | Homepage of Martinus Werts</title>
<meta name="keywords" content="">
<meta name="description" content="Python implementation of the Fraser-Suzuki skewed Gaussian function">
<meta name="author" content="mhvwerts">
<link rel="canonical" href="https://mhvwerts.github.io/posts/skewed_gauss_fraser_suzuki/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://mhvwerts.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://mhvwerts.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://mhvwerts.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://mhvwerts.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://mhvwerts.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://mhvwerts.github.io/posts/skewed_gauss_fraser_suzuki/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:url" content="https://mhvwerts.github.io/posts/skewed_gauss_fraser_suzuki/">
  <meta property="og:site_name" content="Homepage of Martinus Werts">
  <meta property="og:title" content="Python implementation of the Fraser-Suzuki skewed Gaussian function">
  <meta property="og:description" content="Python implementation of the Fraser-Suzuki skewed Gaussian function">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2016-10-02T20:55:48+02:00">
    <meta property="article:modified_time" content="2016-10-02T20:55:48+02:00">
      <meta property="og:image" content="https://mhvwerts.github.io/images/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://mhvwerts.github.io/images/papermod-cover.png">
<meta name="twitter:title" content="Python implementation of the Fraser-Suzuki skewed Gaussian function">
<meta name="twitter:description" content="Python implementation of the Fraser-Suzuki skewed Gaussian function">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://mhvwerts.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Python implementation of the Fraser-Suzuki skewed Gaussian function",
      "item": "https://mhvwerts.github.io/posts/skewed_gauss_fraser_suzuki/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Python implementation of the Fraser-Suzuki skewed Gaussian function",
  "name": "Python implementation of the Fraser-Suzuki skewed Gaussian function",
  "description": "Python implementation of the Fraser-Suzuki skewed Gaussian function",
  "keywords": [
    
  ],
  "articleBody": "The Fraser-Suzuki ‘skewed Gaussian’ function (Fraser \u0026 Suzuki, Anal. Chem. 1969, 41, 37; Rusch \u0026 Lelieur, Anal. Chem. 1973, 45, 1541) is sometimes used to describe the shapes of optical spectra, or chromatographic line shapes. It can be written in the following form.\nfFS(x)={Aexp⁡[−ln⁡2b2{ln⁡(1+2b(x−x0)w)}2]b≠0,2b(x−x0)w\u003e−10b≠0,2b(x−x0)w≤−1Aexp⁡[−4ln⁡2(x−x0)2w2]b=0f_{\\rm FS}(x) = \\begin{cases} {A \\exp \\left [ \\frac{-\\ln 2}{b^2} \\left \\lbrace \\ln \\left ( 1 + \\frac{2b(x-x_0)}{w} \\right ) \\right \\rbrace ^2 \\right ] } \u0026 b \\neq 0, {\\frac{2b(x-x_0)}{w} \u003e -1} \\\\ 0 \u0026 b \\neq 0, {\\frac{2b(x-x_0)}{w} \\leq -1} \\\\ {A \\exp \\left [ -4 \\ln 2 \\frac{(x-x_0)^2}{w^2} \\right ]} \u0026b = 0 \\end{cases} Here, the function is defined piecewice, since the analytical function in the first line of the definition does not exist for all xx , nor for b=0b = 0 . Unfortunately, this cannot be fixed. (BTW, it appears, from limited numerical tests, that our piece-wisely defined skewed Gaussian (cases b≠0b \\neq 0 ) is continuous and differentiable in xx everywhere.)\nBelow, I give a Python/numpy implementation of this function. It is ‘vectorised’, i.e. it handles numpy vectors for high-speed computation, but can also handle individual floats as an argument. The skewed Gaussian is parametrised by AA (the height of the peak), x0x_0 (the position of the peak), ww (proportional to the width of the peak) and bb (the ‘skewness’, or asymmetry). It handles the case where the analytical function vanishes (where the argument of the logarithm ceases to be positive). It also handles the case b=0b =0 , by switching to the symmetric Gaussian below a certain threshold value of bb (where bb will considered to be ‘close’ to zero).\nThis implementation seems to be robust and works for our practical applications, but it may certainly be improved upon. Comments and suggestions are welcome\nimport numpy as np def _skew_gauss_vec(x, A, x0, w, b): \"\"\"vectorised version of skewed Gaussian, called by skew_gauss\"\"\" ndeps = np.finfo(x.dtype.type).eps lim0 = 2.*np.sqrt(ndeps) # Through experimentation I found 2*sqrt(machine_epsilon) to be # a good safe threshold for switching to the b=0 limit # at lower thresholds, numerical rounding errors appear if (abs(b) \u003c= lim0): sg = A * np.exp(-4*np.log(2)*(x-x0)**2/w**2) else: lnterm = 1.0 + ((2*b*(x-x0))/w) sg = np.zeros_like(lnterm) sg[lnterm\u003e0] =\\ A * np.exp(-np.log(2)*(np.log(lnterm[lnterm\u003e0])/b)**2) return sg def skew_gauss(x, A, x0, w, b): \"\"\"Fraser-Suzuki skewed Gaussian. A: peak height, x0: peak position, w: width, b: skewness\"\"\" if type(x)==np.ndarray: sg = _skew_gauss_vec(x, A, x0, w, b) else: x = float(x) ndeps = np.finfo(type(x)).eps lim0 = 2.*np.sqrt(ndeps) if (abs(b) \u003c= lim0): sg = A * np.exp(-4*np.log(2)*(x-x0)**2/w**2) else: lnterm = 1.0 + ((2*b*(x-x0))/w) if (lnterm\u003e0): sg = A * np.exp(-np.log(2)*(np.log(lnterm)/b)**2) else: sg = 0 return sg ",
  "wordCount" : "436",
  "inLanguage": "en",
  "image": "https://mhvwerts.github.io/images/papermod-cover.png","datePublished": "2016-10-02T20:55:48+02:00",
  "dateModified": "2016-10-02T20:55:48+02:00",
  "author":{
    "@type": "Person",
    "name": "mhvwerts"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://mhvwerts.github.io/posts/skewed_gauss_fraser_suzuki/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Homepage of Martinus Werts",
    "logo": {
      "@type": "ImageObject",
      "url": "https://mhvwerts.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://mhvwerts.github.io/" accesskey="h" title="Homepage of Martinus Werts (Alt + H)">Homepage of Martinus Werts</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://mhvwerts.github.io/team/" title="Team">
                    <span>Team</span>
                </a>
            </li>
            <li>
                <a href="https://mhvwerts.github.io/publications/" title="Publications">
                    <span>Publications</span>
                </a>
            </li>
            <li>
                <a href="https://mhvwerts.github.io/posts/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://mhvwerts.github.io/about/" title="Info">
                    <span>Info</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://mhvwerts.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://mhvwerts.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Python implementation of the Fraser-Suzuki skewed Gaussian function
    </h1>
    <div class="post-meta"><span title='2016-10-02 20:55:48 +0200 CEST'>October 2, 2016</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;mhvwerts

</div>
  </header> 

  <div class="post-content"><p>The Fraser-Suzuki &lsquo;skewed Gaussian&rsquo; function (Fraser &amp; Suzuki, <em>Anal. Chem.</em> <strong>1969</strong>, <em>41</em>, 37; Rusch &amp; Lelieur, <em>Anal. Chem.</em> <strong>1973</strong>, <em>45</em>, 1541) is sometimes used to describe the shapes of optical spectra, or chromatographic line shapes. It can be written in the following form.</p>
<!--
<figure>
    <img loading="lazy" src="/images/fraser-suzuki-skewed-gaussian-piecewise-small.png"
         alt="Fraser-Suzuki function"/> 
</figure>

-->
<span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><mi mathvariant="normal">F</mi><mi mathvariant="normal">S</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">[</mo><mfrac><mrow><mo>−</mo><mi>ln</mi><mo>⁡</mo><mn>2</mn></mrow><msup><mi>b</mi><mn>2</mn></msup></mfrac><msup><mrow><mo fence="true">{</mo><mi>ln</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mfrac><mrow><mn>2</mn><mi>b</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mi>w</mi></mfrac><mo fence="true">)</mo></mrow><mo fence="true">}</mo></mrow><mn>2</mn></msup><mo fence="true">]</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>b</mi><mo mathvariant="normal">≠</mo><mn>0</mn><mo separator="true">,</mo><mrow><mfrac><mrow><mn>2</mn><mi>b</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mi>w</mi></mfrac><mo>&gt;</mo><mo>−</mo><mn>1</mn></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>b</mi><mo mathvariant="normal">≠</mo><mn>0</mn><mo separator="true">,</mo><mrow><mfrac><mrow><mn>2</mn><mi>b</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mi>w</mi></mfrac><mo>≤</mo><mo>−</mo><mn>1</mn></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">[</mo><mo>−</mo><mn>4</mn><mi>ln</mi><mo>⁡</mo><mn>2</mn><mfrac><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><msup><mi>w</mi><mn>2</mn></msup></mfrac><mo fence="true">]</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>b</mi><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">f_{\rm FS}(x) = \begin{cases} {A \exp \left [  \frac{-\ln 2}{b^2} \left \lbrace \ln \left ( 1 + \frac{2b(x-x_0)}{w} \right ) \right \rbrace ^2  \right ] } &amp; b \neq 0, {\frac{2b(x-x_0)}{w} &gt; -1} \\ 0 &amp; b \neq 0, {\frac{2b(x-x_0)}{w} \leq -1} \\ {A \exp \left [ -4 \ln 2 \frac{(x-x_0)^2}{w^2}  \right ]} &amp;b = 0 \end{cases}</annotation></semantics></math></span>

<p>Here, the function is defined piecewice, since the analytical function in the first line of the definition does not exist for all <span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span>
, nor for <span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">b = 0</annotation></semantics></math></span>
. Unfortunately, this cannot be fixed. (BTW, it appears, from limited numerical tests, that our piece-wisely defined skewed Gaussian (cases <span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo mathvariant="normal">≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">b \neq 0</annotation></semantics></math></span>
) is continuous and differentiable in <span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span>
 everywhere.)</p>
<p>Below, I give a Python/numpy implementation of this function. It is &lsquo;vectorised&rsquo;, i.e. it handles numpy vectors for high-speed computation, but can also handle individual floats as an argument. The skewed Gaussian is parametrised by <span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span>
 (the height of the peak), <span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span>
 (the position of the peak), <span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span>
 (proportional to the width of the peak) and <span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span>
 (the &lsquo;skewness&rsquo;, or asymmetry). It handles the case where the analytical function vanishes (where the argument of the logarithm ceases to be positive). It also handles the case <span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">b =0 </annotation></semantics></math></span>
, by switching to the symmetric Gaussian below a certain threshold value of <span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span>
 (where <span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span>
 will considered to be &lsquo;close&rsquo; to zero).</p>
<p>This implementation seems to be robust and works for our practical applications, but it may certainly be improved upon. Comments and suggestions are welcome</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">_skew_gauss_vec</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;&#34;&#34;vectorised version of skewed Gaussian, called by skew_gauss&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">ndeps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
</span></span><span class="line"><span class="cl">	<span class="n">lim0</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ndeps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># Through experimentation I found 2*sqrt(machine_epsilon) to be</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># a good safe threshold for switching to the b=0 limit</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># at lower thresholds, numerical rounding errors appear</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">lim0</span><span class="p">):</span> 
</span></span><span class="line"><span class="cl">		<span class="n">sg</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">lnterm</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">))</span><span class="o">/</span><span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">sg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">lnterm</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">sg</span><span class="p">[</span><span class="n">lnterm</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span>\
</span></span><span class="line"><span class="cl">			<span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">lnterm</span><span class="p">[</span><span class="n">lnterm</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">sg</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">skew_gauss</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;&#34;&#34;Fraser-Suzuki skewed Gaussian.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">	A: peak height, x0: peak position, 
</span></span></span><span class="line"><span class="cl"><span class="s2">	w: width, b: skewness&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">sg</span> <span class="o">=</span> <span class="n">_skew_gauss_vec</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">ndeps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">eps</span>
</span></span><span class="line"><span class="cl">		<span class="n">lim0</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ndeps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">lim0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">			<span class="n">sg</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">lnterm</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">))</span><span class="o">/</span><span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span><span class="n">lnterm</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">				<span class="n">sg</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">lnterm</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="n">sg</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">sg</span>
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://mhvwerts.github.io/posts/clyde_midelet_start/">
    <span class="title">« Prev</span>
    <br>
    <span>Ph.D. scholarship (2016-2019) awarded to Clyde Midelet</span>
  </a>
  <a class="next" href="https://mhvwerts.github.io/posts/dep-video/">
    <span class="title">Next »</span>
    <br>
    <span>An electrokinetic video</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Python implementation of the Fraser-Suzuki skewed Gaussian function on bluesky"
            href="https://bsky.app/intent/compose?text=Python%20implementation%20of%20the%20Fraser-Suzuki%20skewed%20Gaussian%20function%20https%3a%2f%2fmhvwerts.github.io%2fposts%2fskewed_gauss_fraser_suzuki%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path d="M111.8 62.2C170.2 105.9 233.3 166.3 256 199.3c22.7-33 85.8-93.4 144.2-137.1C459.8 27.9 512-8.4 512 43.2c0 23.4-5.3 50.9-14.1 81.2-15.4 52.6-46.8 113.4-114.6 125.4 27.9 8.4 64.5 21.9 93.4 40.8 40.3 26.4 64.4 63.3 40.3 63.3-75.3 0-142.3-58.2-261-58.2S75.3 353.9 0 353.9c-24.1 0-.1-36.9 40.3-63.3 28.9-18.9 65.5-32.4 93.4-40.8-67.8-12-99.2-72.8-114.6-125.4C9.3 94.1 4 66.6 4 43.2 4-8.4 56.2 27.9 111.8 62.2z"/>
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Python implementation of the Fraser-Suzuki skewed Gaussian function on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fmhvwerts.github.io%2fposts%2fskewed_gauss_fraser_suzuki%2f&amp;title=Python%20implementation%20of%20the%20Fraser-Suzuki%20skewed%20Gaussian%20function&amp;summary=Python%20implementation%20of%20the%20Fraser-Suzuki%20skewed%20Gaussian%20function&amp;source=https%3a%2f%2fmhvwerts.github.io%2fposts%2fskewed_gauss_fraser_suzuki%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Python implementation of the Fraser-Suzuki skewed Gaussian function on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fmhvwerts.github.io%2fposts%2fskewed_gauss_fraser_suzuki%2f&title=Python%20implementation%20of%20the%20Fraser-Suzuki%20skewed%20Gaussian%20function">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Python implementation of the Fraser-Suzuki skewed Gaussian function on telegram"
            href="https://telegram.me/share/url?text=Python%20implementation%20of%20the%20Fraser-Suzuki%20skewed%20Gaussian%20function&amp;url=https%3a%2f%2fmhvwerts.github.io%2fposts%2fskewed_gauss_fraser_suzuki%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
	<li>
		<a target="_blank" rel="noopener noreferrer" aria-label="share Python implementation of the Fraser-Suzuki skewed Gaussian function on signal"
			href="https://signal.me/#/compose?text=Python%20implementation%20of%20the%20Fraser-Suzuki%20skewed%20Gaussian%20function%20https%3a%2f%2fmhvwerts.github.io%2fposts%2fskewed_gauss_fraser_suzuki%2f">
			<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 1024 1024">
				<path fill="#3a76f0" d="M0,0v1024h1024V0H0z"/>
				<path fill="#ffffff" d="M427.5,170.3l7.9,32A319.6,319.6,0,0,0,347,238.9l-16.9-28.3A347.6,347.6,0,0,1,427.5,170.3Zm169,0-7.9,32A319.6,319.6,0,0,1,677,238.9l17.1-28.3A350.1,350.1,0,0,0,596.5,170.3ZM210.6,330a349.5,349.5,0,0,0-40.3,97.5l32,7.9A319.6,319.6,0,0,1,238.9,347ZM193,512a318.5,318.5,0,0,1,3.6-47.8l-32.6-5a352,352,0,0,0,0,105.5l32.6-4.9A319.5,319.5,0,0,1,193,512ZM693.9,813.3,677,785.1a317.8,317.8,0,0,1-88.3,36.6l7.9,32A350.3,350.3,0,0,0,693.9,813.3ZM831,512a319.5,319.5,0,0,1-3.6,47.8l32.6,4.9a352,352,0,0,0,0-105.5l-32.6,5A318.5,318.5,0,0,1,831,512Zm22.7,84.4-32-7.9A319,319,0,0,1,785.1,677l28.3,17A348.9,348.9,0,0,0,853.7,596.4Zm-293.9,231a319.1,319.1,0,0,1-95.6,0L459.3,860a351.3,351.3,0,0,0,105.4,0Zm209-126.2a318.1,318.1,0,0,1-67.6,67.5l19.6,26.6A355.1,355.1,0,0,0,795.4,721Zm-67.6-446a318.6,318.6,0,0,1,67.6,67.6L795.4,303A354.6,354.6,0,0,0,721,228.6Zm-446,67.6a318.6,318.6,0,0,1,67.6-67.6L303,228.6A354.6,354.6,0,0,0,228.6,303ZM813.4,330l-28.3,17a317.8,317.8,0,0,1,36.6,88.3l32-7.9A348.9,348.9,0,0,0,813.4,330ZM464.2,196.6a319.1,319.1,0,0,1,95.6,0l4.9-32.6a351.3,351.3,0,0,0-105.4,0ZM272.1,804.1,204,819.9l15.9-68.1-32.1-7.5-15.9,68.1a33,33,0,0,0,24.6,39.7,34.5,34.5,0,0,0,15,0l68.1-15.7Zm-77.5-89.2,32.2,7.4,11-47.2a316.2,316.2,0,0,1-35.5-86.6l-32,7.9a353.3,353.3,0,0,0,32.4,83.7Zm154,71.4-47.2,11,7.5,32.2,34.7-8.1a349,349,0,0,0,83.7,32.4l7.9-32a316.7,316.7,0,0,1-86.3-35.7ZM512,226c-158,.1-285.9,128.2-285.9,286.1a286.7,286.7,0,0,0,43.9,152L242.5,781.5,359.8,754c133.7,84.1,310.3,44,394.4-89.6S798.3,354.2,664.7,270A286.7,286.7,0,0,0,512,226s"/>
			</svg>
		</a>
	</li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Python implementation of the Fraser-Suzuki skewed Gaussian function on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Python%20implementation%20of%20the%20Fraser-Suzuki%20skewed%20Gaussian%20function&u=https%3a%2f%2fmhvwerts.github.io%2fposts%2fskewed_gauss_fraser_suzuki%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://mhvwerts.github.io/">Homepage of Martinus Werts</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
